<div id="container">
	<app-sidebar></app-sidebar>
	<div id="content">
		<div *ngIf="hasNotifications()">
			<div *ngFor="let notification of notifications" role="alert" class="alert alert-dismissible" [ngClass]="{'alert-warning': notification.isError(), 'alert-success': !notification.isError()}">
				<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
				{{ notification.message }}
			</div>
		</div>

		<div class="panel panel-info">
			<div class="panel-heading"><h1>Edit Plant Maintenance - {{ deviceName }}</h1></div>
			<div class="panel-body">
				<br/>
				<form *ngIf="maintenance" [formGroup]="editForm" (ngSubmit)="onSubmit()" class="form-horizontal">
					<div class="col-sm-4 col-sm-offset-2">
						<div class="form-group">
							<label for="ph" class="col-sm-3 control-label">pH</label>
							<div class="col-sm-9">
								<input type="text" [formControl]="phCtrl" placeholder="pH" name="ph" class=" form-control" id="ph" value="{{maintenance.ph}}">
							</div>
						</div>
						<div class="form-group">
							<label for="tds" class="col-sm-3 control-label">TDS</label>
							<div class="col-sm-9">
								<input type="text" [formControl]="tdsCtrl" placeholder="TDS" name="tds" class="form-control" id="tds" value="{{maintenance.tds}}">
							</div>
						</div>
						<div class="form-group">
							<label for="type" class="col-sm-3 control-label">Type</label>
							<div class="col-sm-9">
								<select class="custom-select" [formControl]="typeCtrl" name="type" class="form-control" id="type">
									<option *ngFor="let dataType of this.utilService.dataTypes" value="{{ dataType }}">{{ dataType }}</option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<label for="date" class="col-sm-3 control-label">Date</label>
							<div class="col-sm-9 nopadding">
								<div class="col-sm-6">
									<input type="date" class="form-control" style="line-height:unset;"
									[value]="maintenance.d | date:'yyyy-MM-dd'"
									(input)="newDate = $event.target.valueAsDate">
								</div>
								<div class="col-sm-6">
									<input type="time" class="form-control" style="line-height:unset;"
									[value]="maintenance.d | date:'HH:mm:ss'"
									(input)="newTime = this.utilService.convertDateToUTC($event.target.valueAsDate)">
								</div>
							</div>
						</div>
						<div class="form-group">
							<div class="col-sm-offset-3 col-sm-9">
								<button class="btn btn-success btn-md" [disabled]="!editForm.valid">Update</button>
							</div>
						</div>
					</div>

					<div class="col-sm-4">
						<div class="col-lg-6">
							<input type="text" [formControl]="newDetailKeyCtrl" placeholder="key" name="newDetailKey" class="form-control" id="newDetailKey">
						</div>
						<div class="col-lg-5">
							<input type="text" [formControl]="newDetailValueCtrl" placeholder="value" name="newDetailValue" class="form-control" id="newDetailValue">
						</div>
						<div class="col-lg-1">
							<button class="btn btn-success btn-md" type='button' (click)="addDetail()">+</button>
						</div>
						<div *ngIf="hasDetails()">
							<div class="col-lg-12">
								<br/>
							</div>
							<div class="col-lg-12">
								<table class="table table-sm table-no-border nopadnomargin">
									<thead>
										<tr>
											<th scope="col">Detail Key</th>
											<th scope="col">Detail Value</th>
											<th class="col-md-1" scope="col"></th>
										</tr>
									</thead>
									<tbody>
										<tr *ngFor="let detail of maintenance.details">
											<td>{{ detail.key }}</td>
											<td>{{ detail.value }}</td>
											<td><button class="btn btn-danger btn-md material-icons" type='button' (click)="removeDetail(detail)">delete</button></td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
